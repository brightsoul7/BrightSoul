<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Bright Soul</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">


  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <style>
    .dropdown {
        position: relative;
        display: inline;
    }

    
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
    }

    .dropdown-content a, .user-menu-username {
        color: #333;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
    }

   
    .dropdown-content a:hover{
        background-color: #ddd;
    }

    .user-menu:hover .user-menu-content {
      display: block;
  }

    .dropdown:hover .dropdown-content  {
        display: block;
    }

    .user-menu {
      position: relative;
      display: inline-block;
    }

   
    #loggedInUserName {
      cursor: pointer;
      color: #333;
    }

    .user-menu-item a {
      color: #333; /* Set the color to match other menu items */
  }

  .user-menu:hover .user-menu-content {
      display: block;
  }

  .user-menu:hover .user-menu-username:hover + .user-menu-content {
      display: block;
  }

    
    .user-menu-content {
      display:none;
      position: absolute;
      background-color: #f1f1f1;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
      z-index: 1;
    }

    
    .user-menu-content a:hover {
      background-color: #ddd;
    }

  
    
    
    
    .user-menu-item a {
      color: #333; /* Set the color to match other menu items */
    }

    .user-menu:hover .user-menu-content {
      display: block;
    }
    
    .dropdown:hover .dropdown-content {
      display: block;
    }
    
    .user-menu-content,
    .dropdown-content {
      display: none;
    }
    
    .sidebar {
      height: 100%;
      width: 250px;
      background-color: #f2f2f2;
      position: fixed;
      padding-top: 80px;
  }

  .sidebar a {
      padding: 15px 25px;
      text-align: left;
      text-decoration: none;
      font-size: 18px;
      color: #333;
      display: block;
  }

  .sidebar a:hover {
      background-color: #ddd;
  }
    
  .content {
    margin-left: 270px;
    padding: 20px;
    margin-bottom: 100px;
}

.footer {
  background-color: #333;
  color: white;
  text-align: center;
  padding: 10px;
  position: absolute;
  bottom: 0;
  width: 100%;
  z-index: 2; /* Add z-index to keep the footer on top */
}

/* Card Styles */
.card-container {
  display: none;
  flex-wrap: wrap;
}

.card {
  width: calc(33.33% - 20px);
  margin: 10px;
  border: 1px solid #ddd;
  padding: 10px;
  background-color: #fff;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.event-container {
  margin-top: 60px;
  margin-left: 270px;
  padding: 20px;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  color-scheme: rgb(0, 0, 0);
  margin-bottom: 150px;
}

.event-card {
  background-color: rgba(23, 172, 205, 0.886) ;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  border-radius: 5px;
  margin: 10px;
  width: calc(33.33% - 20px);
  padding: 10px;
  
  color-scheme: rgb(0, 0, 0);
}

.event-card img {
  width: 100%;
  height: 200px;
  object-fit: cover;
  border-radius: 5px 5px 0 0;
  color: rgb(0, 0, 0);
}

.event-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: rgb(0, 0, 0);
}

.event-date {
  color: #000000;
  margin-top: 10px;
}

.event-price {
  color: red;
  margin-top: 10px;
}

.event-description {
  margin-top: 10px;
  color: rgb(0, 0, 0);
}

</style>

</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center">
    <div class="container d-flex align-items-center">

      <h1 class="logo me-auto"><a href="index.html">Bright soul</a></h1>


      <nav id="navbar" class="navbar">
        <ul>
          <li><a href="index.html" >Home</a></li>

          
          <div class="dropdown">
            <a href="#">Self Help</a></li>
            <div class="dropdown-content">
                <a href="videos.html">Videos</a>
                <a href="Music.html">Music</a>
            </div> 
          </div>
       
      </style>
      <div class="dropdown">
        <a href="#">Article     </a></li>
        <div class="dropdown-content">
            <a href="blog.html">Blogs</a>
            <a href="videos.html">Videos</a>
        </div> 
    </div>  
    <li><a href="events.html"  style="padding-right:10px;">Events</a></li>
    <li><a href="Book.html">Books</a></li>    
    <li><a href="main page.html" style="padding-right:10px;">Relaxation practices</a></li>  
    <li id="loginListItem" class="user-menu-item">
      <a href="login.html" class="getstarted" id="loginButton">Login</a>
    </li>
    <div class="user-menu">
      <span id="loggedInUserName" class="user-menu-username">Your Name</span>
      <div class="user-menu-content">
        <a href="profile.html">My Profile</a>
        <a id="logoutLink" href="#">Logout</a>
      </div>
    </div>
    <li ><a href="admin.html"  class="admin-menu-item">Admin</a></li>

        </ul>
  <i class="bi bi-list mobile-nav-toggle"></i>
</nav><!-- .navbar -->

    </div>
  </header>
  
  <div class="sidebar" style="height: 100%; padding-top:20px;">
    <a href="#" onclick="showEvents()">Events</a>
    <a href="#" onclick="showAppointments()">Appointments</a>
</div>


<!--
<div class="event-container" style="margin-top: 60px; margin-left: 270px;">
  <div class="card-container event-card" id="event-cards">
    
  </div>
</div>-->

<div class="event-container" id="event-container" style="margin-top: 60px; margin-left: 270px;">
  <!-- Event cards will be dynamically added here -->
  
</div>
<div class="appointments-container" id="appointment-container" style="margin-top: 60px; margin-left: 270px;">
  <!-- Event cards will be dynamically added here -->
  
</div>


<!-- 
  <footer id="footer" class="footer" style="height: 450px; position: fixed; bottom: 0; width: 100%;">
    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-3 col-md-6">
            <div class="footer-info">
              <h3>Bright soul</h3>
              <p>
               1200 dalls drive <br>
                denton texas USA<br><br>
                <strong>Phone:</strong> +1 9999999999<br>
                <strong>Email:</strong> info@example.com<br>
              </p>
              <div class="social-links mt-3">
                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
              </div>
            </div>
          </div>

         

        </div>
      </div>
    </div>

    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong><span>Bright soul</span></strong>. All Rights Reserved
      </div>
      <div class="credits">

        Designed by <a href="">Brightsoul</a>
      </div>
    </div>
  </footer>  -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>


  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

  <script>
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const userMenu = document.querySelector('.user-menu');
    const userMenuContent = document.querySelector('.user-menu-content');


    const isAdmin = localStorage.getItem('isAdmin');
    const adminMenuItems = document.querySelector('.admin-menu-item');


    if (isAdmin === 'true') {
      adminMenuItems.style.display = 'block';
    } else {
      adminMenuItems.style.display = 'none';
    }


  
    if (isLoggedIn === 'true') {
      // User is logged in
      const username = localStorage.getItem('loggedInUser');
      const loginButton = document.getElementById('loginButton');
      const loggedInUserName = document.getElementById('loggedInUserName');

  
      loginButton.style.display = 'none';
      loggedInUserName.textContent = username;
      
      loggedInUserName.addEventListener('mouseenter', () => {
        userMenuContent.style.display = 'block';
      });
  
      // Add a click event for the logout link
      const logoutLink = document.getElementById('logoutLink');
      logoutLink.addEventListener('click', () => {
        localStorage.setItem('isLoggedIn', 'false');
        window.location.href = 'index.html'; 
      });
    } else {
      userMenu.style.display = 'none';
    }

userMenu.addEventListener('mouseleave', () => {
  userMenuContent.style.display = 'none';
});





function showEvents() {
  // Check if the user is logged in
  const isLoggedIn = localStorage.getItem('isLoggedIn');
  const bearerToken = localStorage.getItem('access_token'); 
  const userId = localStorage.getItem('user_id'); 
 // const cardContainer = document.getElementById('event-cards');
 const eventContainer = document.getElementById('event-container');



  if (isLoggedIn === 'true' && bearerToken) {
    const apiUrl = `http://localhost:3000/events/${userId}`;
    //const apiUrl = `http://localhost:3000/events/5`;

    fetch(apiUrl, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${bearerToken}`,
        'Content-Type': 'application/json',
      },
    })
      .then((response) => {
        if (response.ok) {
          return response.json();
        } else {
          console.error('API request failed with status:', response.status);
        }
      })
      
      .then((data) => {
        if (Array.isArray(data)) {
          // Clear any existing cards
          eventContainer.innerHTML = '';

          // Loop through the event data and create cards
          //<img src="${event.image}" alt="${event.event_title}">
          data.forEach((event) => {
            const eventCard = document.createElement('div');
            eventCard.className = 'event-card';
            eventCard.innerHTML = `
              
              <div class="event-title">${event.event_title}</div>
              <div class="event-date">${event.event_date}</div>
              <div class="event-price">Price: ${event.price}</div>
              <p class="event-description">${event.event_description}</p>
            `;
            eventContainer.appendChild(eventCard)
          });
        } else {
          // Handle the case when the response data is not an array
          console.log(data+"This is data")
          console.error('Invalid data format.');
        }
        console.log('API response:', data);
      })
      .catch((error) => {
        console.error('API request error:', error);
      });
  } else {
    console.log('User is not logged in or does not have a bearer token.');
  }
}



function showAppointments() {
  // Check if the user is logged in
  const isLoggedIn = localStorage.getItem('isLoggedIn');
  const bearerToken = localStorage.getItem('access_token'); 
  const userId = localStorage.getItem('user_id'); 
 // const cardContainer = document.getElementById('event-cards');
 const appointmentsContainer = document.getElementById('appointment-container');



  if (isLoggedIn === 'true' && bearerToken) {
    //const apiUrl = `http://localhost:3000/api/v1/appointments/5`;
    const apiUrl = `http://localhost:3000/api/v1/appointments/${userId}`;

    fetch(apiUrl, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${bearerToken}`,
        'Content-Type': 'application/json',
      },
    })
      .then((response) => {
        if (response.ok) {
          return response.json();
        } else {
          console.error('API request failed with status:', response.status);
        }
      })


    
      
      .then((data) => {
        if (Array.isArray(data)) {

          console.log(data+"this is data")
          // Clear any existing cards
          appointmentsContainer.innerHTML = '';

          // Loop through the event data and create cards
          //<img src="${event.image}" alt="${event.event_title}">
          data.forEach((event) => {

           


            const appointmentCard = document.createElement('div');
            console.log(event+"this is event")
            appointmentCard.className = 'card';
            appointmentCard.innerHTML = `
            <img src="./assets/img/14.jpeg" class="card-img-top" alt="Card Image">
            <div class="card-body">
              <h5 class="card-title">${event.name}</h5>
              <p class="card-text">${event.appointment_details}</p>
            </div>  
            
           
            `;
            appointmentsContainer.appendChild(appointmentCard)
          });
        } else {
          console.log(data+"This is data")
          console.error('Invalid data format.');
        }
        console.log('API response:', data);
      })
      .catch((error) => {
        console.error('API request error:', error);
      });
  } else {
    console.log('User is not logged in or does not have a bearer token.');
  }
}



  </script>
</body>

</html>